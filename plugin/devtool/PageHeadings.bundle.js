"use strict";
(self["webpackChunkaloha"] = self["webpackChunkaloha"] || []).push([["PageHeadings"],{

/***/ "./src/views/PageHeadings/PageHeadings.vue":
/*!*************************************************!*\
  !*** ./src/views/PageHeadings/PageHeadings.vue ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _PageHeadings_pug_vue_type_template_id_4bcfad85_lang_pug_external__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external */ "./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external");
/* harmony import */ var _PageHeadings_js_vue_type_script_lang_js_external__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PageHeadings.js?vue&type=script&lang=js&external */ "./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external?e38b");
/* harmony import */ var _node_modules_vue_loader_dist_exportHelper_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../node_modules/vue-loader/dist/exportHelper.js */ "./node_modules/vue-loader/dist/exportHelper.js");




;
const __exports__ = /*#__PURE__*/(0,_node_modules_vue_loader_dist_exportHelper_js__WEBPACK_IMPORTED_MODULE_2__["default"])(_PageHeadings_js_vue_type_script_lang_js_external__WEBPACK_IMPORTED_MODULE_1__["default"], [['render',_PageHeadings_pug_vue_type_template_id_4bcfad85_lang_pug_external__WEBPACK_IMPORTED_MODULE_0__.render],['__file',"src/views/PageHeadings/PageHeadings.vue"]])
/* hot reload */
if (false) {}


/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (__exports__);

/***/ }),

/***/ "./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external":
/*!*************************************************************************************************!*\
  !*** ./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   render: () => (/* reexport safe */ _node_modules_vue_loader_dist_templateLoader_js_ruleSet_1_rules_1_node_modules_vue_pug_loader_index_js_PageHeadings_pug_vue_type_template_id_4bcfad85_lang_pug_external__WEBPACK_IMPORTED_MODULE_0__.render)
/* harmony export */ });
/* harmony import */ var _node_modules_vue_loader_dist_templateLoader_js_ruleSet_1_rules_1_node_modules_vue_pug_loader_index_js_PageHeadings_pug_vue_type_template_id_4bcfad85_lang_pug_external__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!../../../node_modules/vue-pug-loader/index.js!./PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external */ "./node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!./node_modules/vue-pug-loader/index.js!./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external");


/***/ }),

/***/ "./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external?e38b":
/*!*********************************************************************************!*\
  !*** ./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* reexport safe */ _PageHeadings_js_vue_type_script_lang_js_external__WEBPACK_IMPORTED_MODULE_0__["default"])
/* harmony export */ });
/* harmony import */ var _PageHeadings_js_vue_type_script_lang_js_external__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./PageHeadings.js?vue&type=script&lang=js&external */ "./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external?b71f");
 

/***/ }),

/***/ "./node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!./node_modules/vue-pug-loader/index.js!./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external":
/*!**************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!./node_modules/vue-pug-loader/index.js!./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external ***!
  \**************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   render: () => (/* binding */ render)
/* harmony export */ });
/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vue */ "./node_modules/vue/dist/vue.esm-bundler.js");


function render(_ctx, _cache) {
  const _component_a_translation = (0,vue__WEBPACK_IMPORTED_MODULE_0__.resolveComponent)("a-translation")
  const _component_a_element = (0,vue__WEBPACK_IMPORTED_MODULE_0__.resolveComponent)("a-element")

  return ((0,vue__WEBPACK_IMPORTED_MODULE_0__.openBlock)(), (0,vue__WEBPACK_IMPORTED_MODULE_0__.createElementBlock)("div", null, [
    (0,vue__WEBPACK_IMPORTED_MODULE_0__.createVNode)(_component_a_translation, {
      tag: "h1",
      text: "_HEADINGS_H1_H6_"
    }),
    (0,vue__WEBPACK_IMPORTED_MODULE_0__.createElementVNode)("div", null, [
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createVNode)(_component_a_element, {
        class: "a_btn a_btn_secondary",
        type: "button",
        text: _ctx.textForBtnToggleHeadings,
        onClick: _ctx.toggleHeadings
      }, null, 8 /* PROPS */, ["text", "onClick"]),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)(" a-element.a_btn.a_btn_secondary("),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)("   type=\"button\""),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)("   text=\"_HEADINGS_CHECK_\""),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)("   @click=\"checkHeadings\""),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)(" )")
    ])
  ]))
}

/***/ }),

/***/ "./src/functions/utils.js":
/*!********************************!*\
  !*** ./src/functions/utils.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   traverse: () => (/* binding */ traverse)
/* harmony export */ });
function traverse(tags = [], className, stop = false) {
  traverseNew(window, tags, stop);

  function traverseNew(currentWindow = window, tags = [], stop) {
    deleteTags(currentWindow);
    try {
      if (!stop) {
        for (let i = 0; i < tags.length; i++) {
          insertTag(currentWindow, tags[i]);
        }
      }
      for (let i = 0; i < currentWindow.frames.length; i++) {
        traverseNew(currentWindow.frames[i], tags, stop);
      }
    } catch (e) {
      console.warn(e);
    }

    function deleteTags(currentWindow) {
      const ALL_TAGS = currentWindow.document.querySelectorAll(`.${ className }`);
      ALL_TAGS.forEach(element => {
        element.parentNode.removeChild(element);
      });
    }

    function insertTag(w, tag) {
      const CURRENT_TAGS = w.document.getElementsByTagName(tag.name);
      for (let i = 0; i < CURRENT_TAGS.length; i++) {
        if (!tag.insertInParent) {
          CURRENT_TAGS[i].insertBefore(createTag(w, tag, ""), CURRENT_TAGS[i].firstChild);
          CURRENT_TAGS[i].appendChild(createTag(w, tag, "/"));
        } else {
          CURRENT_TAGS[i].parentNode.insertBefore(createTag(w, tag, ""), CURRENT_TAGS[i]);
          CURRENT_TAGS[i].parentNode.insertBefore(createTag(w, tag, "/"), CURRENT_TAGS[i].nextSibling);
        }
      }
    }

    function createTag(w, tag, slash) {
      const SPAN = w.document.createElement("span");
      SPAN.className = className;
      const STYLE = SPAN.style;
      STYLE.color = tag.color;
      STYLE.backgroundColor = "#fff";
      STYLE.backgroundImage = "none";
      STYLE.fontSize = tag.fontSize || "1.2rem";
      STYLE.fontWeight = "bold";
      STYLE.padding = "0.3rem";
      STYLE.border = `1px solid ${ tag.color }`;
      const TEXT_NODE = w.document.createTextNode("<" + slash + tag.name + ">");
      SPAN.insertBefore(TEXT_NODE, SPAN.firstChild);
      return SPAN;
    }
  }
}


/***/ }),

/***/ "./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external?b71f":
/*!*********************************************************************************!*\
  !*** ./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var aloha_vue_src_ATranslation_ATranslation__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aloha-vue/src/ATranslation/ATranslation */ "./node_modules/aloha-vue/src/ATranslation/ATranslation.js");
/* harmony import */ var aloha_vue_src_AElement_AElement__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aloha-vue/src/AElement/AElement */ "./node_modules/aloha-vue/src/AElement/AElement.js");
/* harmony import */ var _compositionAPI_EventsAPI__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./compositionAPI/EventsAPI */ "./src/views/PageHeadings/compositionAPI/EventsAPI.js");





/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
  name: "PageHeadings",
  components: {
    AElement: aloha_vue_src_AElement_AElement__WEBPACK_IMPORTED_MODULE_1__["default"],
    ATranslation: aloha_vue_src_ATranslation_ATranslation__WEBPACK_IMPORTED_MODULE_0__["default"],
  },
  setup() {
    const {
      checkHeadings,
      textForBtnToggleHeadings,
      toggleHeadings,
    } = (0,_compositionAPI_EventsAPI__WEBPACK_IMPORTED_MODULE_2__["default"])();

    return {
      checkHeadings,
      textForBtnToggleHeadings,
      toggleHeadings,
    };
  },
});


/***/ }),

/***/ "./src/views/PageHeadings/compositionAPI/EventsAPI.js":
/*!************************************************************!*\
  !*** ./src/views/PageHeadings/compositionAPI/EventsAPI.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ EventsAPI)
/* harmony export */ });
/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vue */ "./node_modules/vue/dist/vue.esm-bundler.js");
/* harmony import */ var _functions_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../functions/utils */ "./src/functions/utils.js");
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash-es */ "./node_modules/lodash/lodash.js");
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash_es__WEBPACK_IMPORTED_MODULE_2__);





function EventsAPI() {
  const chromeTabId = (0,vue__WEBPACK_IMPORTED_MODULE_0__.inject)("chromeTabId");

  const isHeadingsVisible = (0,vue__WEBPACK_IMPORTED_MODULE_0__.ref)(false);
  const TAGS = [
    {
      name: "H1",
      color: "#ff0000",
      insertInParent: false,
    },
    {
      name: "H2",
      color: "#713939",
      insertInParent: false,
    },
    {
      name: "H3",
      color: "#00aa00",
      insertInParent: false,
    },
    {
      name: "H4",
      color: "#054164",
      insertInParent: false,
    },
    {
      name: "H5",
      color: "#7F0A7F",
      insertInParent: false,
    },
    {
      name: "H6",
      color: "#01D901",
      insertInParent: false,
    },
  ];

  const toggleHeadings = ({ statusStop } = {}) => {
    const STATUS_STOP = (0,lodash_es__WEBPACK_IMPORTED_MODULE_2__.isUndefined)(statusStop) ?
      !!isHeadingsVisible.value :
      statusStop;
    chrome.scripting.executeScript(
      {
        target: {
          tabId: chromeTabId.value,
          allFrames: true,
        },
        function: _functions_utils__WEBPACK_IMPORTED_MODULE_1__.traverse,
        args: [TAGS, "a11y_heading", STATUS_STOP],
      }
    );
    isHeadingsVisible.value = !STATUS_STOP;
  };

  const textForBtnToggleHeadings = (0,vue__WEBPACK_IMPORTED_MODULE_0__.computed)(() => {
    return isHeadingsVisible.value ?
      "_HEADINGS_HIDE_" :
      "_HEADINGS_SHOW_";
  });

  const checkHeadings = async() => {
    const [TAB] = await chrome.tabs.query({ active: true, currentWindow: true });

    chrome.scripting.executeScript(
      {
        target: {
          tabId: TAB.id,
          allFrames: true,
        },
        function: _checkHeadings,
        args: [TAGS, "a11y_heading", !!isHeadingsVisible.value],
      }
    );
  };

  function _checkHeadings() {
    checkHeadingsInWindow(window);

    function checkHeadingsInWindow(currentWindow = window) {
      try {
        findAllHeadings(currentWindow);
        // TODO: frames
        // for (let i = 0; i < currentWindow.frames.length; i++) {
        //   checkHeadingsInWindow(currentWindow.frames[i]);
        // }
      } catch (e) {
        console.warn(e);
      }
    }

    function findAllHeadings(currentWindow) {
      const HEADINGS = currentWindow.document.querySelectorAll("h1, h2, h3, h4, h5, h6");
      const HEADINGS_VISIBLE = [];
      // tagName
      HEADINGS.forEach(element => {
        if (isElementVisible(element)) {
          HEADINGS_VISIBLE.push(element);
        }
      });
      console.log("HEADINGS_VISIBLE", HEADINGS_VISIBLE);
      console.log("length", HEADINGS_VISIBLE.length);
    }

    function isElementVisible(element) {
      return element.offsetWidth > 0 && element.offsetHeight > 0;
    }
  }

  return {
    checkHeadings,
    textForBtnToggleHeadings,
    toggleHeadings,
  };
}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2Fsb2hhLy4vc3JjL3ZpZXdzL1BhZ2VIZWFkaW5ncy9QYWdlSGVhZGluZ3MudnVlIiwid2VicGFjazovL2Fsb2hhLy4vc3JjL3ZpZXdzL1BhZ2VIZWFkaW5ncy9QYWdlSGVhZGluZ3MuanM/ZTM4YiIsIndlYnBhY2s6Ly9hbG9oYS8uL3NyYy92aWV3cy9QYWdlSGVhZGluZ3MvUGFnZUhlYWRpbmdzLnB1ZyIsIndlYnBhY2s6Ly9hbG9oYS8uL3NyYy9mdW5jdGlvbnMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vYWxvaGEvLi9zcmMvdmlld3MvUGFnZUhlYWRpbmdzL1BhZ2VIZWFkaW5ncy5qcyIsIndlYnBhY2s6Ly9hbG9oYS8uL3NyYy92aWV3cy9QYWdlSGVhZGluZ3MvY29tcG9zaXRpb25BUEkvRXZlbnRzQVBJLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciB9IGZyb20gXCIuL1BhZ2VIZWFkaW5ncy5wdWc/dnVlJnR5cGU9dGVtcGxhdGUmaWQ9NGJjZmFkODUmbGFuZz1wdWcmZXh0ZXJuYWxcIlxuaW1wb3J0IHNjcmlwdCBmcm9tIFwiLi9QYWdlSGVhZGluZ3MuanM/dnVlJnR5cGU9c2NyaXB0Jmxhbmc9anMmZXh0ZXJuYWxcIlxuZXhwb3J0ICogZnJvbSBcIi4vUGFnZUhlYWRpbmdzLmpzP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJmV4dGVybmFsXCJcblxuaW1wb3J0IGV4cG9ydENvbXBvbmVudCBmcm9tIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvZGlzdC9leHBvcnRIZWxwZXIuanNcIlxuY29uc3QgX19leHBvcnRzX18gPSAvKiNfX1BVUkVfXyovZXhwb3J0Q29tcG9uZW50KHNjcmlwdCwgW1sncmVuZGVyJyxyZW5kZXJdLFsnX19maWxlJyxcInNyYy92aWV3cy9QYWdlSGVhZGluZ3MvUGFnZUhlYWRpbmdzLnZ1ZVwiXV0pXG4vKiBob3QgcmVsb2FkICovXG5pZiAobW9kdWxlLmhvdCkge1xuICBfX2V4cG9ydHNfXy5fX2htcklkID0gXCI0YmNmYWQ4NVwiXG4gIGNvbnN0IGFwaSA9IF9fVlVFX0hNUl9SVU5USU1FX19cbiAgbW9kdWxlLmhvdC5hY2NlcHQoKVxuICBpZiAoIWFwaS5jcmVhdGVSZWNvcmQoJzRiY2ZhZDg1JywgX19leHBvcnRzX18pKSB7XG4gICAgYXBpLnJlbG9hZCgnNGJjZmFkODUnLCBfX2V4cG9ydHNfXylcbiAgfVxuICBcbiAgbW9kdWxlLmhvdC5hY2NlcHQoXCIuL1BhZ2VIZWFkaW5ncy5wdWc/dnVlJnR5cGU9dGVtcGxhdGUmaWQ9NGJjZmFkODUmbGFuZz1wdWcmZXh0ZXJuYWxcIiwgKCkgPT4ge1xuICAgIGFwaS5yZXJlbmRlcignNGJjZmFkODUnLCByZW5kZXIpXG4gIH0pXG5cbn1cblxuXG5leHBvcnQgZGVmYXVsdCBfX2V4cG9ydHNfXyIsImV4cG9ydCB7IGRlZmF1bHQgfSBmcm9tIFwiLSEuL1BhZ2VIZWFkaW5ncy5qcz92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZleHRlcm5hbFwiOyBleHBvcnQgKiBmcm9tIFwiLSEuL1BhZ2VIZWFkaW5ncy5qcz92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZleHRlcm5hbFwiIiwiPGRpdj48YS10cmFuc2xhdGlvbiB0YWc9XCJoMVwiIHRleHQ9XCJfSEVBRElOR1NfSDFfSDZfXCI+PC9hLXRyYW5zbGF0aW9uPjxkaXY+PGEtZWxlbWVudCBjbGFzcz1cImFfYnRuIGFfYnRuX3NlY29uZGFyeVwiIHR5cGU9XCJidXR0b25cIiA6dGV4dD1cInRleHRGb3JCdG5Ub2dnbGVIZWFkaW5nc1wiIEBjbGljaz1cInRvZ2dsZUhlYWRpbmdzXCI+PC9hLWVsZW1lbnQ+PCEtLSBhLWVsZW1lbnQuYV9idG4uYV9idG5fc2Vjb25kYXJ5KC0tPjwhLS0gICB0eXBlPVwiYnV0dG9uXCItLT48IS0tICAgdGV4dD1cIl9IRUFESU5HU19DSEVDS19cIi0tPjwhLS0gICBAY2xpY2s9XCJjaGVja0hlYWRpbmdzXCItLT48IS0tICktLT48L2Rpdj48L2Rpdj4iLCJleHBvcnQgZnVuY3Rpb24gdHJhdmVyc2UodGFncyA9IFtdLCBjbGFzc05hbWUsIHN0b3AgPSBmYWxzZSkge1xyXG4gIHRyYXZlcnNlTmV3KHdpbmRvdywgdGFncywgc3RvcCk7XHJcblxyXG4gIGZ1bmN0aW9uIHRyYXZlcnNlTmV3KGN1cnJlbnRXaW5kb3cgPSB3aW5kb3csIHRhZ3MgPSBbXSwgc3RvcCkge1xyXG4gICAgZGVsZXRlVGFncyhjdXJyZW50V2luZG93KTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICghc3RvcCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFncy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgaW5zZXJ0VGFnKGN1cnJlbnRXaW5kb3csIHRhZ3NbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnJlbnRXaW5kb3cuZnJhbWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdHJhdmVyc2VOZXcoY3VycmVudFdpbmRvdy5mcmFtZXNbaV0sIHRhZ3MsIHN0b3ApO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihlKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkZWxldGVUYWdzKGN1cnJlbnRXaW5kb3cpIHtcclxuICAgICAgY29uc3QgQUxMX1RBR1MgPSBjdXJyZW50V2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC4keyBjbGFzc05hbWUgfWApO1xyXG4gICAgICBBTExfVEFHUy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW5zZXJ0VGFnKHcsIHRhZykge1xyXG4gICAgICBjb25zdCBDVVJSRU5UX1RBR1MgPSB3LmRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZy5uYW1lKTtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBDVVJSRU5UX1RBR1MubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoIXRhZy5pbnNlcnRJblBhcmVudCkge1xyXG4gICAgICAgICAgQ1VSUkVOVF9UQUdTW2ldLmluc2VydEJlZm9yZShjcmVhdGVUYWcodywgdGFnLCBcIlwiKSwgQ1VSUkVOVF9UQUdTW2ldLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgQ1VSUkVOVF9UQUdTW2ldLmFwcGVuZENoaWxkKGNyZWF0ZVRhZyh3LCB0YWcsIFwiL1wiKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIENVUlJFTlRfVEFHU1tpXS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjcmVhdGVUYWcodywgdGFnLCBcIlwiKSwgQ1VSUkVOVF9UQUdTW2ldKTtcclxuICAgICAgICAgIENVUlJFTlRfVEFHU1tpXS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjcmVhdGVUYWcodywgdGFnLCBcIi9cIiksIENVUlJFTlRfVEFHU1tpXS5uZXh0U2libGluZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY3JlYXRlVGFnKHcsIHRhZywgc2xhc2gpIHtcclxuICAgICAgY29uc3QgU1BBTiA9IHcuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XHJcbiAgICAgIFNQQU4uY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xyXG4gICAgICBjb25zdCBTVFlMRSA9IFNQQU4uc3R5bGU7XHJcbiAgICAgIFNUWUxFLmNvbG9yID0gdGFnLmNvbG9yO1xyXG4gICAgICBTVFlMRS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNmZmZcIjtcclxuICAgICAgU1RZTEUuYmFja2dyb3VuZEltYWdlID0gXCJub25lXCI7XHJcbiAgICAgIFNUWUxFLmZvbnRTaXplID0gdGFnLmZvbnRTaXplIHx8IFwiMS4ycmVtXCI7XHJcbiAgICAgIFNUWUxFLmZvbnRXZWlnaHQgPSBcImJvbGRcIjtcclxuICAgICAgU1RZTEUucGFkZGluZyA9IFwiMC4zcmVtXCI7XHJcbiAgICAgIFNUWUxFLmJvcmRlciA9IGAxcHggc29saWQgJHsgdGFnLmNvbG9yIH1gO1xyXG4gICAgICBjb25zdCBURVhUX05PREUgPSB3LmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiPFwiICsgc2xhc2ggKyB0YWcubmFtZSArIFwiPlwiKTtcclxuICAgICAgU1BBTi5pbnNlcnRCZWZvcmUoVEVYVF9OT0RFLCBTUEFOLmZpcnN0Q2hpbGQpO1xyXG4gICAgICByZXR1cm4gU1BBTjtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IEFUcmFuc2xhdGlvbiBmcm9tIFwiYWxvaGEtdnVlL3NyYy9BVHJhbnNsYXRpb24vQVRyYW5zbGF0aW9uXCI7XHJcbmltcG9ydCBBRWxlbWVudCBmcm9tIFwiYWxvaGEtdnVlL3NyYy9BRWxlbWVudC9BRWxlbWVudFwiO1xyXG5cclxuaW1wb3J0IEV2ZW50c0FQSSBmcm9tIFwiLi9jb21wb3NpdGlvbkFQSS9FdmVudHNBUElcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICBuYW1lOiBcIlBhZ2VIZWFkaW5nc1wiLFxyXG4gIGNvbXBvbmVudHM6IHtcclxuICAgIEFFbGVtZW50LFxyXG4gICAgQVRyYW5zbGF0aW9uLFxyXG4gIH0sXHJcbiAgc2V0dXAoKSB7XHJcbiAgICBjb25zdCB7XHJcbiAgICAgIGNoZWNrSGVhZGluZ3MsXHJcbiAgICAgIHRleHRGb3JCdG5Ub2dnbGVIZWFkaW5ncyxcclxuICAgICAgdG9nZ2xlSGVhZGluZ3MsXHJcbiAgICB9ID0gRXZlbnRzQVBJKCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY2hlY2tIZWFkaW5ncyxcclxuICAgICAgdGV4dEZvckJ0blRvZ2dsZUhlYWRpbmdzLFxyXG4gICAgICB0b2dnbGVIZWFkaW5ncyxcclxuICAgIH07XHJcbiAgfSxcclxufTtcclxuIiwiaW1wb3J0IHtcclxuICBjb21wdXRlZCxcclxuICBpbmplY3QsXHJcbiAgcmVmLFxyXG59IGZyb20gXCJ2dWVcIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgdHJhdmVyc2UsXHJcbn0gZnJvbSBcIi4uLy4uLy4uL2Z1bmN0aW9ucy91dGlsc1wiO1xyXG5pbXBvcnQge1xyXG4gIGlzVW5kZWZpbmVkLFxyXG59IGZyb20gXCJsb2Rhc2gtZXNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEV2ZW50c0FQSSgpIHtcclxuICBjb25zdCBjaHJvbWVUYWJJZCA9IGluamVjdChcImNocm9tZVRhYklkXCIpO1xyXG5cclxuICBjb25zdCBpc0hlYWRpbmdzVmlzaWJsZSA9IHJlZihmYWxzZSk7XHJcbiAgY29uc3QgVEFHUyA9IFtcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJIMVwiLFxyXG4gICAgICBjb2xvcjogXCIjZmYwMDAwXCIsXHJcbiAgICAgIGluc2VydEluUGFyZW50OiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiSDJcIixcclxuICAgICAgY29sb3I6IFwiIzcxMzkzOVwiLFxyXG4gICAgICBpbnNlcnRJblBhcmVudDogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkgzXCIsXHJcbiAgICAgIGNvbG9yOiBcIiMwMGFhMDBcIixcclxuICAgICAgaW5zZXJ0SW5QYXJlbnQ6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJINFwiLFxyXG4gICAgICBjb2xvcjogXCIjMDU0MTY0XCIsXHJcbiAgICAgIGluc2VydEluUGFyZW50OiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiSDVcIixcclxuICAgICAgY29sb3I6IFwiIzdGMEE3RlwiLFxyXG4gICAgICBpbnNlcnRJblBhcmVudDogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkg2XCIsXHJcbiAgICAgIGNvbG9yOiBcIiMwMUQ5MDFcIixcclxuICAgICAgaW5zZXJ0SW5QYXJlbnQ6IGZhbHNlLFxyXG4gICAgfSxcclxuICBdO1xyXG5cclxuICBjb25zdCB0b2dnbGVIZWFkaW5ncyA9ICh7IHN0YXR1c1N0b3AgfSA9IHt9KSA9PiB7XHJcbiAgICBjb25zdCBTVEFUVVNfU1RPUCA9IGlzVW5kZWZpbmVkKHN0YXR1c1N0b3ApID9cclxuICAgICAgISFpc0hlYWRpbmdzVmlzaWJsZS52YWx1ZSA6XHJcbiAgICAgIHN0YXR1c1N0b3A7XHJcbiAgICBjaHJvbWUuc2NyaXB0aW5nLmV4ZWN1dGVTY3JpcHQoXHJcbiAgICAgIHtcclxuICAgICAgICB0YXJnZXQ6IHtcclxuICAgICAgICAgIHRhYklkOiBjaHJvbWVUYWJJZC52YWx1ZSxcclxuICAgICAgICAgIGFsbEZyYW1lczogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uOiB0cmF2ZXJzZSxcclxuICAgICAgICBhcmdzOiBbVEFHUywgXCJhMTF5X2hlYWRpbmdcIiwgU1RBVFVTX1NUT1BdLFxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gICAgaXNIZWFkaW5nc1Zpc2libGUudmFsdWUgPSAhU1RBVFVTX1NUT1A7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgdGV4dEZvckJ0blRvZ2dsZUhlYWRpbmdzID0gY29tcHV0ZWQoKCkgPT4ge1xyXG4gICAgcmV0dXJuIGlzSGVhZGluZ3NWaXNpYmxlLnZhbHVlID9cclxuICAgICAgXCJfSEVBRElOR1NfSElERV9cIiA6XHJcbiAgICAgIFwiX0hFQURJTkdTX1NIT1dfXCI7XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGNoZWNrSGVhZGluZ3MgPSBhc3luYygpID0+IHtcclxuICAgIGNvbnN0IFtUQUJdID0gYXdhaXQgY2hyb21lLnRhYnMucXVlcnkoeyBhY3RpdmU6IHRydWUsIGN1cnJlbnRXaW5kb3c6IHRydWUgfSk7XHJcblxyXG4gICAgY2hyb21lLnNjcmlwdGluZy5leGVjdXRlU2NyaXB0KFxyXG4gICAgICB7XHJcbiAgICAgICAgdGFyZ2V0OiB7XHJcbiAgICAgICAgICB0YWJJZDogVEFCLmlkLFxyXG4gICAgICAgICAgYWxsRnJhbWVzOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb246IF9jaGVja0hlYWRpbmdzLFxyXG4gICAgICAgIGFyZ3M6IFtUQUdTLCBcImExMXlfaGVhZGluZ1wiLCAhIWlzSGVhZGluZ3NWaXNpYmxlLnZhbHVlXSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBfY2hlY2tIZWFkaW5ncygpIHtcclxuICAgIGNoZWNrSGVhZGluZ3NJbldpbmRvdyh3aW5kb3cpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNoZWNrSGVhZGluZ3NJbldpbmRvdyhjdXJyZW50V2luZG93ID0gd2luZG93KSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgZmluZEFsbEhlYWRpbmdzKGN1cnJlbnRXaW5kb3cpO1xyXG4gICAgICAgIC8vIFRPRE86IGZyYW1lc1xyXG4gICAgICAgIC8vIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudFdpbmRvdy5mcmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAvLyAgIGNoZWNrSGVhZGluZ3NJbldpbmRvdyhjdXJyZW50V2luZG93LmZyYW1lc1tpXSk7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZmluZEFsbEhlYWRpbmdzKGN1cnJlbnRXaW5kb3cpIHtcclxuICAgICAgY29uc3QgSEVBRElOR1MgPSBjdXJyZW50V2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJoMSwgaDIsIGgzLCBoNCwgaDUsIGg2XCIpO1xyXG4gICAgICBjb25zdCBIRUFESU5HU19WSVNJQkxFID0gW107XHJcbiAgICAgIC8vIHRhZ05hbWVcclxuICAgICAgSEVBRElOR1MuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICBpZiAoaXNFbGVtZW50VmlzaWJsZShlbGVtZW50KSkge1xyXG4gICAgICAgICAgSEVBRElOR1NfVklTSUJMRS5wdXNoKGVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiSEVBRElOR1NfVklTSUJMRVwiLCBIRUFESU5HU19WSVNJQkxFKTtcclxuICAgICAgY29uc29sZS5sb2coXCJsZW5ndGhcIiwgSEVBRElOR1NfVklTSUJMRS5sZW5ndGgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzRWxlbWVudFZpc2libGUoZWxlbWVudCkge1xyXG4gICAgICByZXR1cm4gZWxlbWVudC5vZmZzZXRXaWR0aCA+IDAgJiYgZWxlbWVudC5vZmZzZXRIZWlnaHQgPiAwO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGNoZWNrSGVhZGluZ3MsXHJcbiAgICB0ZXh0Rm9yQnRuVG9nZ2xlSGVhZGluZ3MsXHJcbiAgICB0b2dnbGVIZWFkaW5ncyxcclxuICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJ0ZXh0Rm9yQnRuVG9nZ2xlSGVhZGluZ3MiLCJ0b2dnbGVIZWFkaW5ncyJdLCJzb3VyY2VSb290IjoiIn0=