"use strict";
(self["webpackChunkaloha"] = self["webpackChunkaloha"] || []).push([["PageHeadings"],{

/***/ "./src/views/PageHeadings/PageHeadings.vue":
/*!*************************************************!*\
  !*** ./src/views/PageHeadings/PageHeadings.vue ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _PageHeadings_pug_vue_type_template_id_4bcfad85_lang_pug_external__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external */ "./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external");
/* harmony import */ var _PageHeadings_js_vue_type_script_lang_js_external__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PageHeadings.js?vue&type=script&lang=js&external */ "./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external?e38b");
/* harmony import */ var _node_modules_vue_loader_dist_exportHelper_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../node_modules/vue-loader/dist/exportHelper.js */ "./node_modules/vue-loader/dist/exportHelper.js");




;
const __exports__ = /*#__PURE__*/(0,_node_modules_vue_loader_dist_exportHelper_js__WEBPACK_IMPORTED_MODULE_2__["default"])(_PageHeadings_js_vue_type_script_lang_js_external__WEBPACK_IMPORTED_MODULE_1__["default"], [['render',_PageHeadings_pug_vue_type_template_id_4bcfad85_lang_pug_external__WEBPACK_IMPORTED_MODULE_0__.render],['__file',"src/views/PageHeadings/PageHeadings.vue"]])
/* hot reload */
if (false) {}


/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (__exports__);

/***/ }),

/***/ "./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external":
/*!*************************************************************************************************!*\
  !*** ./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   render: () => (/* reexport safe */ _node_modules_vue_loader_dist_templateLoader_js_ruleSet_1_rules_1_node_modules_vue_pug_loader_index_js_PageHeadings_pug_vue_type_template_id_4bcfad85_lang_pug_external__WEBPACK_IMPORTED_MODULE_0__.render)
/* harmony export */ });
/* harmony import */ var _node_modules_vue_loader_dist_templateLoader_js_ruleSet_1_rules_1_node_modules_vue_pug_loader_index_js_PageHeadings_pug_vue_type_template_id_4bcfad85_lang_pug_external__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!../../../node_modules/vue-pug-loader/index.js!./PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external */ "./node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!./node_modules/vue-pug-loader/index.js!./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external");


/***/ }),

/***/ "./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external?e38b":
/*!*********************************************************************************!*\
  !*** ./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* reexport safe */ _PageHeadings_js_vue_type_script_lang_js_external__WEBPACK_IMPORTED_MODULE_0__["default"])
/* harmony export */ });
/* harmony import */ var _PageHeadings_js_vue_type_script_lang_js_external__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./PageHeadings.js?vue&type=script&lang=js&external */ "./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external?b71f");
 

/***/ }),

/***/ "./node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!./node_modules/vue-pug-loader/index.js!./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external":
/*!**************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[1]!./node_modules/vue-pug-loader/index.js!./src/views/PageHeadings/PageHeadings.pug?vue&type=template&id=4bcfad85&lang=pug&external ***!
  \**************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   render: () => (/* binding */ render)
/* harmony export */ });
/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vue */ "./node_modules/vue/dist/vue.esm-bundler.js");


function render(_ctx, _cache) {
  const _component_a_translation = (0,vue__WEBPACK_IMPORTED_MODULE_0__.resolveComponent)("a-translation")
  const _component_a_element = (0,vue__WEBPACK_IMPORTED_MODULE_0__.resolveComponent)("a-element")

  return ((0,vue__WEBPACK_IMPORTED_MODULE_0__.openBlock)(), (0,vue__WEBPACK_IMPORTED_MODULE_0__.createElementBlock)("div", null, [
    (0,vue__WEBPACK_IMPORTED_MODULE_0__.createVNode)(_component_a_translation, {
      tag: "h1",
      text: "_HEADINGS_H1_H6_"
    }),
    (0,vue__WEBPACK_IMPORTED_MODULE_0__.createElementVNode)("div", null, [
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createVNode)(_component_a_element, {
        class: "a_btn a_btn_secondary",
        type: "button",
        text: _ctx.textForBtnToggleHeadings,
        onClick: _ctx.toggleHeadings
      }, null, 8 /* PROPS */, ["text", "onClick"]),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)(" a-element.a_btn.a_btn_secondary("),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)("   type=\"button\""),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)("   text=\"_HEADINGS_CHECK_\""),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)("   @click=\"checkHeadings\""),
      (0,vue__WEBPACK_IMPORTED_MODULE_0__.createCommentVNode)(" )")
    ])
  ]))
}

/***/ }),

/***/ "./src/functions/utils.js":
/*!********************************!*\
  !*** ./src/functions/utils.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   traverse: () => (/* binding */ traverse)
/* harmony export */ });
function traverse(tags = [], className, stop = false) {
  traverseNew(window, tags, stop);

  function traverseNew(currentWindow = window, tags = [], stop) {
    deleteTags(currentWindow);
    try {
      if (!stop) {
        for (let i = 0; i < tags.length; i++) {
          insertTag(currentWindow, tags[i]);
        }
      }
      for (let i = 0; i < currentWindow.frames.length; i++) {
        traverseNew(currentWindow.frames[i], tags, stop);
      }
    } catch (e) {
      console.warn(e);
    }

    function deleteTags(currentWindow) {
      const ALL_TAGS = currentWindow.document.querySelectorAll(`.${ className }`);
      ALL_TAGS.forEach(element => {
        element.parentNode.removeChild(element);
      });
    }

    function insertTag(w, tag) {
      const CURRENT_TAGS = w.document.getElementsByTagName(tag.name);
      for (let i = 0; i < CURRENT_TAGS.length; i++) {
        if (!tag.insertInParent) {
          CURRENT_TAGS[i].insertBefore(createTag(w, tag, ""), CURRENT_TAGS[i].firstChild);
          CURRENT_TAGS[i].appendChild(createTag(w, tag, "/"));
        } else {
          CURRENT_TAGS[i].parentNode.insertBefore(createTag(w, tag, ""), CURRENT_TAGS[i]);
          CURRENT_TAGS[i].parentNode.insertBefore(createTag(w, tag, "/"), CURRENT_TAGS[i].nextSibling);
        }
      }
    }

    function createTag(w, tag, slash) {
      const SPAN = w.document.createElement("span");
      SPAN.className = className;
      const STYLE = SPAN.style;
      STYLE.color = tag.color;
      STYLE.backgroundColor = "#fff";
      STYLE.backgroundImage = "none";
      STYLE.fontSize = tag.fontSize || "1.2rem";
      STYLE.fontWeight = "bold";
      STYLE.padding = "0.3rem";
      STYLE.border = `1px solid ${ tag.color }`;
      const TEXT_NODE = w.document.createTextNode("<" + slash + tag.name + ">");
      SPAN.insertBefore(TEXT_NODE, SPAN.firstChild);
      return SPAN;
    }
  }
}


/***/ }),

/***/ "./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external?b71f":
/*!*********************************************************************************!*\
  !*** ./src/views/PageHeadings/PageHeadings.js?vue&type=script&lang=js&external ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var aloha_vue_src_ATranslation_ATranslation__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aloha-vue/src/ATranslation/ATranslation */ "./node_modules/aloha-vue/src/ATranslation/ATranslation.js");
/* harmony import */ var aloha_vue_src_AElement_AElement__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aloha-vue/src/AElement/AElement */ "./node_modules/aloha-vue/src/AElement/AElement.js");
/* harmony import */ var _compositionAPI_EventsAPI__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./compositionAPI/EventsAPI */ "./src/views/PageHeadings/compositionAPI/EventsAPI.js");





/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
  name: "PageHeadings",
  components: {
    AElement: aloha_vue_src_AElement_AElement__WEBPACK_IMPORTED_MODULE_1__["default"],
    ATranslation: aloha_vue_src_ATranslation_ATranslation__WEBPACK_IMPORTED_MODULE_0__["default"],
  },
  setup() {
    const {
      checkHeadings,
      textForBtnToggleHeadings,
      toggleHeadings,
    } = (0,_compositionAPI_EventsAPI__WEBPACK_IMPORTED_MODULE_2__["default"])();

    return {
      checkHeadings,
      textForBtnToggleHeadings,
      toggleHeadings,
    };
  },
});


/***/ }),

/***/ "./src/views/PageHeadings/compositionAPI/EventsAPI.js":
/*!************************************************************!*\
  !*** ./src/views/PageHeadings/compositionAPI/EventsAPI.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ EventsAPI)
/* harmony export */ });
/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vue */ "./node_modules/vue/dist/vue.esm-bundler.js");
/* harmony import */ var _functions_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../functions/utils */ "./src/functions/utils.js");
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash-es */ "./node_modules/lodash/lodash.js");
/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash_es__WEBPACK_IMPORTED_MODULE_2__);





function EventsAPI() {
  const chromeTabId = (0,vue__WEBPACK_IMPORTED_MODULE_0__.inject)("chromeTabId");

  const isHeadingsVisible = (0,vue__WEBPACK_IMPORTED_MODULE_0__.ref)(false);

  const TAGS = [
    {
      name: "H1",
      color: "#ff0000",
      insertInParent: false,
    },
    {
      name: "H2",
      color: "#713939",
      insertInParent: false,
    },
    {
      name: "H3",
      color: "#00aa00",
      insertInParent: false,
    },
    {
      name: "H4",
      color: "#054164",
      insertInParent: false,
    },
    {
      name: "H5",
      color: "#7F0A7F",
      insertInParent: false,
    },
    {
      name: "H6",
      color: "#01D901",
      insertInParent: false,
    },
  ];

  const toggleHeadings = ({ statusStop } = {}) => {
    const STATUS_STOP = (0,lodash_es__WEBPACK_IMPORTED_MODULE_2__.isUndefined)(statusStop) ?
      !!isHeadingsVisible.value :
      statusStop;
    chrome.scripting.executeScript(
      {
        target: {
          tabId: chromeTabId.value,
          allFrames: true,
        },
        function: _functions_utils__WEBPACK_IMPORTED_MODULE_1__.traverse,
        args: [TAGS, "a11y_heading", STATUS_STOP],
      }
    );
    isHeadingsVisible.value = !STATUS_STOP;
  };

  const textForBtnToggleHeadings = (0,vue__WEBPACK_IMPORTED_MODULE_0__.computed)(() => {
    return isHeadingsVisible.value ?
      "_HEADINGS_HIDE_" :
      "_HEADINGS_SHOW_";
  });

  const checkHeadings = async() => {
    const [TAB] = await chrome.tabs.query({ active: true, currentWindow: true });

    chrome.scripting.executeScript(
      {
        target: {
          tabId: TAB.id,
          allFrames: true,
        },
        function: _checkHeadings,
        args: [TAGS, "a11y_heading", !!isHeadingsVisible.value],
      }
    );
  };

  function _checkHeadings() {
    checkHeadingsInWindow(window);

    function checkHeadingsInWindow(currentWindow = window) {
      try {
        findAllHeadings(currentWindow);
        // TODO: frames
        // for (let i = 0; i < currentWindow.frames.length; i++) {
        //   checkHeadingsInWindow(currentWindow.frames[i]);
        // }
      } catch (e) {
        console.warn(e);
      }
    }

    function findAllHeadings(currentWindow) {
      const HEADINGS = currentWindow.document.querySelectorAll("h1, h2, h3, h4, h5, h6");
      const HEADINGS_VISIBLE = [];
      // tagName
      HEADINGS.forEach(element => {
        if (isElementVisible(element)) {
          HEADINGS_VISIBLE.push(element);
        }
      });
      console.log("HEADINGS_VISIBLE", HEADINGS_VISIBLE);
      console.log("length", HEADINGS_VISIBLE.length);
    }

    function isElementVisible(element) {
      return element.offsetWidth > 0 && element.offsetHeight > 0;
    }
  }

  return {
    checkHeadings,
    textForBtnToggleHeadings,
    toggleHeadings,
  };
}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWxvaGEvLi9zcmMvdmlld3MvUGFnZUhlYWRpbmdzL1BhZ2VIZWFkaW5ncy52dWUiLCJ3ZWJwYWNrOi8vYWxvaGEvLi9zcmMvdmlld3MvUGFnZUhlYWRpbmdzL1BhZ2VIZWFkaW5ncy5qcz9lMzhiIiwid2VicGFjazovL2Fsb2hhLy4vc3JjL3ZpZXdzL1BhZ2VIZWFkaW5ncy9QYWdlSGVhZGluZ3MucHVnIiwid2VicGFjazovL2Fsb2hhLy4vc3JjL2Z1bmN0aW9ucy91dGlscy5qcyIsIndlYnBhY2s6Ly9hbG9oYS8uL3NyYy92aWV3cy9QYWdlSGVhZGluZ3MvUGFnZUhlYWRpbmdzLmpzIiwid2VicGFjazovL2Fsb2hhLy4vc3JjL3ZpZXdzL1BhZ2VIZWFkaW5ncy9jb21wb3NpdGlvbkFQSS9FdmVudHNBUEkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVuZGVyIH0gZnJvbSBcIi4vUGFnZUhlYWRpbmdzLnB1Zz92dWUmdHlwZT10ZW1wbGF0ZSZpZD00YmNmYWQ4NSZsYW5nPXB1ZyZleHRlcm5hbFwiXG5pbXBvcnQgc2NyaXB0IGZyb20gXCIuL1BhZ2VIZWFkaW5ncy5qcz92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZleHRlcm5hbFwiXG5leHBvcnQgKiBmcm9tIFwiLi9QYWdlSGVhZGluZ3MuanM/dnVlJnR5cGU9c2NyaXB0Jmxhbmc9anMmZXh0ZXJuYWxcIlxuXG5pbXBvcnQgZXhwb3J0Q29tcG9uZW50IGZyb20gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9kaXN0L2V4cG9ydEhlbHBlci5qc1wiXG5jb25zdCBfX2V4cG9ydHNfXyA9IC8qI19fUFVSRV9fKi9leHBvcnRDb21wb25lbnQoc2NyaXB0LCBbWydyZW5kZXInLHJlbmRlcl0sWydfX2ZpbGUnLFwic3JjL3ZpZXdzL1BhZ2VIZWFkaW5ncy9QYWdlSGVhZGluZ3MudnVlXCJdXSlcbi8qIGhvdCByZWxvYWQgKi9cbmlmIChtb2R1bGUuaG90KSB7XG4gIF9fZXhwb3J0c19fLl9faG1ySWQgPSBcIjRiY2ZhZDg1XCJcbiAgY29uc3QgYXBpID0gX19WVUVfSE1SX1JVTlRJTUVfX1xuICBtb2R1bGUuaG90LmFjY2VwdCgpXG4gIGlmICghYXBpLmNyZWF0ZVJlY29yZCgnNGJjZmFkODUnLCBfX2V4cG9ydHNfXykpIHtcbiAgICBhcGkucmVsb2FkKCc0YmNmYWQ4NScsIF9fZXhwb3J0c19fKVxuICB9XG4gIFxuICBtb2R1bGUuaG90LmFjY2VwdChcIi4vUGFnZUhlYWRpbmdzLnB1Zz92dWUmdHlwZT10ZW1wbGF0ZSZpZD00YmNmYWQ4NSZsYW5nPXB1ZyZleHRlcm5hbFwiLCAoKSA9PiB7XG4gICAgYXBpLnJlcmVuZGVyKCc0YmNmYWQ4NScsIHJlbmRlcilcbiAgfSlcblxufVxuXG5cbmV4cG9ydCBkZWZhdWx0IF9fZXhwb3J0c19fIiwiZXhwb3J0IHsgZGVmYXVsdCB9IGZyb20gXCItIS4vUGFnZUhlYWRpbmdzLmpzP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJmV4dGVybmFsXCI7IGV4cG9ydCAqIGZyb20gXCItIS4vUGFnZUhlYWRpbmdzLmpzP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJmV4dGVybmFsXCIiLCI8ZGl2PjxhLXRyYW5zbGF0aW9uIHRhZz1cImgxXCIgdGV4dD1cIl9IRUFESU5HU19IMV9INl9cIj48L2EtdHJhbnNsYXRpb24+PGRpdj48YS1lbGVtZW50IGNsYXNzPVwiYV9idG4gYV9idG5fc2Vjb25kYXJ5XCIgdHlwZT1cImJ1dHRvblwiIDp0ZXh0PVwidGV4dEZvckJ0blRvZ2dsZUhlYWRpbmdzXCIgQGNsaWNrPVwidG9nZ2xlSGVhZGluZ3NcIj48L2EtZWxlbWVudD48IS0tIGEtZWxlbWVudC5hX2J0bi5hX2J0bl9zZWNvbmRhcnkoLS0+PCEtLSAgIHR5cGU9XCJidXR0b25cIi0tPjwhLS0gICB0ZXh0PVwiX0hFQURJTkdTX0NIRUNLX1wiLS0+PCEtLSAgIEBjbGljaz1cImNoZWNrSGVhZGluZ3NcIi0tPjwhLS0gKS0tPjwvZGl2PjwvZGl2PiIsImV4cG9ydCBmdW5jdGlvbiB0cmF2ZXJzZSh0YWdzID0gW10sIGNsYXNzTmFtZSwgc3RvcCA9IGZhbHNlKSB7XHJcbiAgdHJhdmVyc2VOZXcod2luZG93LCB0YWdzLCBzdG9wKTtcclxuXHJcbiAgZnVuY3Rpb24gdHJhdmVyc2VOZXcoY3VycmVudFdpbmRvdyA9IHdpbmRvdywgdGFncyA9IFtdLCBzdG9wKSB7XHJcbiAgICBkZWxldGVUYWdzKGN1cnJlbnRXaW5kb3cpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKCFzdG9wKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YWdzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBpbnNlcnRUYWcoY3VycmVudFdpbmRvdywgdGFnc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudFdpbmRvdy5mcmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB0cmF2ZXJzZU5ldyhjdXJyZW50V2luZG93LmZyYW1lc1tpXSwgdGFncywgc3RvcCk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS53YXJuKGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGRlbGV0ZVRhZ3MoY3VycmVudFdpbmRvdykge1xyXG4gICAgICBjb25zdCBBTExfVEFHUyA9IGN1cnJlbnRXaW5kb3cuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLiR7IGNsYXNzTmFtZSB9YCk7XHJcbiAgICAgIEFMTF9UQUdTLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpbnNlcnRUYWcodywgdGFnKSB7XHJcbiAgICAgIGNvbnN0IENVUlJFTlRfVEFHUyA9IHcuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnLm5hbWUpO1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IENVUlJFTlRfVEFHUy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmICghdGFnLmluc2VydEluUGFyZW50KSB7XHJcbiAgICAgICAgICBDVVJSRU5UX1RBR1NbaV0uaW5zZXJ0QmVmb3JlKGNyZWF0ZVRhZyh3LCB0YWcsIFwiXCIpLCBDVVJSRU5UX1RBR1NbaV0uZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICBDVVJSRU5UX1RBR1NbaV0uYXBwZW5kQ2hpbGQoY3JlYXRlVGFnKHcsIHRhZywgXCIvXCIpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgQ1VSUkVOVF9UQUdTW2ldLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNyZWF0ZVRhZyh3LCB0YWcsIFwiXCIpLCBDVVJSRU5UX1RBR1NbaV0pO1xyXG4gICAgICAgICAgQ1VSUkVOVF9UQUdTW2ldLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNyZWF0ZVRhZyh3LCB0YWcsIFwiL1wiKSwgQ1VSUkVOVF9UQUdTW2ldLm5leHRTaWJsaW5nKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVUYWcodywgdGFnLCBzbGFzaCkge1xyXG4gICAgICBjb25zdCBTUEFOID0gdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcclxuICAgICAgU1BBTi5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgIGNvbnN0IFNUWUxFID0gU1BBTi5zdHlsZTtcclxuICAgICAgU1RZTEUuY29sb3IgPSB0YWcuY29sb3I7XHJcbiAgICAgIFNUWUxFLmJhY2tncm91bmRDb2xvciA9IFwiI2ZmZlwiO1xyXG4gICAgICBTVFlMRS5iYWNrZ3JvdW5kSW1hZ2UgPSBcIm5vbmVcIjtcclxuICAgICAgU1RZTEUuZm9udFNpemUgPSB0YWcuZm9udFNpemUgfHwgXCIxLjJyZW1cIjtcclxuICAgICAgU1RZTEUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gICAgICBTVFlMRS5wYWRkaW5nID0gXCIwLjNyZW1cIjtcclxuICAgICAgU1RZTEUuYm9yZGVyID0gYDFweCBzb2xpZCAkeyB0YWcuY29sb3IgfWA7XHJcbiAgICAgIGNvbnN0IFRFWFRfTk9ERSA9IHcuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCI8XCIgKyBzbGFzaCArIHRhZy5uYW1lICsgXCI+XCIpO1xyXG4gICAgICBTUEFOLmluc2VydEJlZm9yZShURVhUX05PREUsIFNQQU4uZmlyc3RDaGlsZCk7XHJcbiAgICAgIHJldHVybiBTUEFOO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgQVRyYW5zbGF0aW9uIGZyb20gXCJhbG9oYS12dWUvc3JjL0FUcmFuc2xhdGlvbi9BVHJhbnNsYXRpb25cIjtcclxuaW1wb3J0IEFFbGVtZW50IGZyb20gXCJhbG9oYS12dWUvc3JjL0FFbGVtZW50L0FFbGVtZW50XCI7XHJcblxyXG5pbXBvcnQgRXZlbnRzQVBJIGZyb20gXCIuL2NvbXBvc2l0aW9uQVBJL0V2ZW50c0FQSVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gIG5hbWU6IFwiUGFnZUhlYWRpbmdzXCIsXHJcbiAgY29tcG9uZW50czoge1xyXG4gICAgQUVsZW1lbnQsXHJcbiAgICBBVHJhbnNsYXRpb24sXHJcbiAgfSxcclxuICBzZXR1cCgpIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgY2hlY2tIZWFkaW5ncyxcclxuICAgICAgdGV4dEZvckJ0blRvZ2dsZUhlYWRpbmdzLFxyXG4gICAgICB0b2dnbGVIZWFkaW5ncyxcclxuICAgIH0gPSBFdmVudHNBUEkoKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjaGVja0hlYWRpbmdzLFxyXG4gICAgICB0ZXh0Rm9yQnRuVG9nZ2xlSGVhZGluZ3MsXHJcbiAgICAgIHRvZ2dsZUhlYWRpbmdzLFxyXG4gICAgfTtcclxuICB9LFxyXG59O1xyXG4iLCJpbXBvcnQge1xyXG4gIGNvbXB1dGVkLFxyXG4gIGluamVjdCxcclxuICByZWYsXHJcbn0gZnJvbSBcInZ1ZVwiO1xyXG5cclxuaW1wb3J0IHtcclxuICB0cmF2ZXJzZSxcclxufSBmcm9tIFwiLi4vLi4vLi4vZnVuY3Rpb25zL3V0aWxzXCI7XHJcbmltcG9ydCB7XHJcbiAgaXNVbmRlZmluZWQsXHJcbn0gZnJvbSBcImxvZGFzaC1lc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gRXZlbnRzQVBJKCkge1xyXG4gIGNvbnN0IGNocm9tZVRhYklkID0gaW5qZWN0KFwiY2hyb21lVGFiSWRcIik7XHJcblxyXG4gIGNvbnN0IGlzSGVhZGluZ3NWaXNpYmxlID0gcmVmKGZhbHNlKTtcclxuXHJcbiAgY29uc3QgVEFHUyA9IFtcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJIMVwiLFxyXG4gICAgICBjb2xvcjogXCIjZmYwMDAwXCIsXHJcbiAgICAgIGluc2VydEluUGFyZW50OiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiSDJcIixcclxuICAgICAgY29sb3I6IFwiIzcxMzkzOVwiLFxyXG4gICAgICBpbnNlcnRJblBhcmVudDogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkgzXCIsXHJcbiAgICAgIGNvbG9yOiBcIiMwMGFhMDBcIixcclxuICAgICAgaW5zZXJ0SW5QYXJlbnQ6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJINFwiLFxyXG4gICAgICBjb2xvcjogXCIjMDU0MTY0XCIsXHJcbiAgICAgIGluc2VydEluUGFyZW50OiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiSDVcIixcclxuICAgICAgY29sb3I6IFwiIzdGMEE3RlwiLFxyXG4gICAgICBpbnNlcnRJblBhcmVudDogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkg2XCIsXHJcbiAgICAgIGNvbG9yOiBcIiMwMUQ5MDFcIixcclxuICAgICAgaW5zZXJ0SW5QYXJlbnQ6IGZhbHNlLFxyXG4gICAgfSxcclxuICBdO1xyXG5cclxuICBjb25zdCB0b2dnbGVIZWFkaW5ncyA9ICh7IHN0YXR1c1N0b3AgfSA9IHt9KSA9PiB7XHJcbiAgICBjb25zdCBTVEFUVVNfU1RPUCA9IGlzVW5kZWZpbmVkKHN0YXR1c1N0b3ApID9cclxuICAgICAgISFpc0hlYWRpbmdzVmlzaWJsZS52YWx1ZSA6XHJcbiAgICAgIHN0YXR1c1N0b3A7XHJcbiAgICBjaHJvbWUuc2NyaXB0aW5nLmV4ZWN1dGVTY3JpcHQoXHJcbiAgICAgIHtcclxuICAgICAgICB0YXJnZXQ6IHtcclxuICAgICAgICAgIHRhYklkOiBjaHJvbWVUYWJJZC52YWx1ZSxcclxuICAgICAgICAgIGFsbEZyYW1lczogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uOiB0cmF2ZXJzZSxcclxuICAgICAgICBhcmdzOiBbVEFHUywgXCJhMTF5X2hlYWRpbmdcIiwgU1RBVFVTX1NUT1BdLFxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gICAgaXNIZWFkaW5nc1Zpc2libGUudmFsdWUgPSAhU1RBVFVTX1NUT1A7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgdGV4dEZvckJ0blRvZ2dsZUhlYWRpbmdzID0gY29tcHV0ZWQoKCkgPT4ge1xyXG4gICAgcmV0dXJuIGlzSGVhZGluZ3NWaXNpYmxlLnZhbHVlID9cclxuICAgICAgXCJfSEVBRElOR1NfSElERV9cIiA6XHJcbiAgICAgIFwiX0hFQURJTkdTX1NIT1dfXCI7XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGNoZWNrSGVhZGluZ3MgPSBhc3luYygpID0+IHtcclxuICAgIGNvbnN0IFtUQUJdID0gYXdhaXQgY2hyb21lLnRhYnMucXVlcnkoeyBhY3RpdmU6IHRydWUsIGN1cnJlbnRXaW5kb3c6IHRydWUgfSk7XHJcblxyXG4gICAgY2hyb21lLnNjcmlwdGluZy5leGVjdXRlU2NyaXB0KFxyXG4gICAgICB7XHJcbiAgICAgICAgdGFyZ2V0OiB7XHJcbiAgICAgICAgICB0YWJJZDogVEFCLmlkLFxyXG4gICAgICAgICAgYWxsRnJhbWVzOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZnVuY3Rpb246IF9jaGVja0hlYWRpbmdzLFxyXG4gICAgICAgIGFyZ3M6IFtUQUdTLCBcImExMXlfaGVhZGluZ1wiLCAhIWlzSGVhZGluZ3NWaXNpYmxlLnZhbHVlXSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBfY2hlY2tIZWFkaW5ncygpIHtcclxuICAgIGNoZWNrSGVhZGluZ3NJbldpbmRvdyh3aW5kb3cpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNoZWNrSGVhZGluZ3NJbldpbmRvdyhjdXJyZW50V2luZG93ID0gd2luZG93KSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgZmluZEFsbEhlYWRpbmdzKGN1cnJlbnRXaW5kb3cpO1xyXG4gICAgICAgIC8vIFRPRE86IGZyYW1lc1xyXG4gICAgICAgIC8vIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudFdpbmRvdy5mcmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAvLyAgIGNoZWNrSGVhZGluZ3NJbldpbmRvdyhjdXJyZW50V2luZG93LmZyYW1lc1tpXSk7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZmluZEFsbEhlYWRpbmdzKGN1cnJlbnRXaW5kb3cpIHtcclxuICAgICAgY29uc3QgSEVBRElOR1MgPSBjdXJyZW50V2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJoMSwgaDIsIGgzLCBoNCwgaDUsIGg2XCIpO1xyXG4gICAgICBjb25zdCBIRUFESU5HU19WSVNJQkxFID0gW107XHJcbiAgICAgIC8vIHRhZ05hbWVcclxuICAgICAgSEVBRElOR1MuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICBpZiAoaXNFbGVtZW50VmlzaWJsZShlbGVtZW50KSkge1xyXG4gICAgICAgICAgSEVBRElOR1NfVklTSUJMRS5wdXNoKGVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiSEVBRElOR1NfVklTSUJMRVwiLCBIRUFESU5HU19WSVNJQkxFKTtcclxuICAgICAgY29uc29sZS5sb2coXCJsZW5ndGhcIiwgSEVBRElOR1NfVklTSUJMRS5sZW5ndGgpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGlzRWxlbWVudFZpc2libGUoZWxlbWVudCkge1xyXG4gICAgICByZXR1cm4gZWxlbWVudC5vZmZzZXRXaWR0aCA+IDAgJiYgZWxlbWVudC5vZmZzZXRIZWlnaHQgPiAwO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGNoZWNrSGVhZGluZ3MsXHJcbiAgICB0ZXh0Rm9yQnRuVG9nZ2xlSGVhZGluZ3MsXHJcbiAgICB0b2dnbGVIZWFkaW5ncyxcclxuICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJ0ZXh0Rm9yQnRuVG9nZ2xlSGVhZGluZ3MiLCJ0b2dnbGVIZWFkaW5ncyJdLCJzb3VyY2VSb290IjoiIn0=